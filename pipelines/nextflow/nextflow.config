/*
 * eveHap Nextflow Configuration
 *
 * Profiles for different execution environments.
 * IMPORTANT: --tree and --reference are REQUIRED!
 */

// Default parameters
params {
    input = null
    outdir = 'results'
    tree = null         // REQUIRED: 'rsrs', 'rcrs', or path
    reference = null    // REQUIRED: 'rcrs' or path
    method = 'auto'
    damage_filter = false
    sample_id = null
}

// Process configuration
process {
    // Default resources
    cpus = 1
    memory = '2 GB'
    time = '1h'

    // Container (if using Docker/Singularity)
    // container = 'evehap:latest'

    withName: 'EVEHAP_CLASSIFY' {
        cpus = 1
        memory = '4 GB'
    }

    withName: 'EVEHAP_DAMAGE' {
        cpus = 1
        memory = '2 GB'
    }
}

// Execution profiles
profiles {
    // Local execution
    standard {
        process.executor = 'local'
    }

    // SLURM cluster
    slurm {
        process.executor = 'slurm'
        process.queue = 'normal'
        process.clusterOptions = '--account=your_account'
    }

    // PBS/Torque cluster
    pbs {
        process.executor = 'pbs'
        process.queue = 'batch'
    }

    // Docker
    docker {
        docker.enabled = true
        docker.runOptions = '-u $(id -u):$(id -g)'
    }

    // Singularity (HPC)
    singularity {
        singularity.enabled = true
        singularity.autoMounts = true
    }

    // Ancient DNA mode
    ancient {
        params.damage_filter = true
        params.method = 'traversal'
    }
}

// Manifest
manifest {
    name = 'evehap-pipeline'
    author = 'eveHap Authors'
    description = 'mtDNA haplogroup classification pipeline'
    version = '0.1.0'
    mainScript = 'main.nf'
}

// Reports
report {
    enabled = true
    file = "${params.outdir}/reports/execution_report.html"
}

timeline {
    enabled = true
    file = "${params.outdir}/reports/timeline.html"
}

trace {
    enabled = true
    file = "${params.outdir}/reports/trace.txt"
}
